<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - SGMRP</title>
    <meta name="description" content="Registre-se no Sistema de Gerenciamento de Mapas de Refei√ß√µes Penitenci√°rio">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/validation.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="{{ url_for('index') }}" class="logo">SGMRP</a>
                <nav>
                    <ul>
                        <li><a href="{{ url_for('index') }}">In√≠cio</a></li>
                        <li><a href="{{ url_for('login') }}">Login</a></li>
                        <li><a href="{{ url_for('cadastro') }}" class="active">Cadastro</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <div class="container" style="max-width: 600px; margin-top: 2rem;">
            <!-- Breadcrumb -->
            <nav aria-label="Navega√ß√£o" style="margin-bottom: 2.5rem; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 0.75rem 1.25rem; box-shadow: 0 2px 8px rgba(0,0,0,0.03);">
                <div style="display: flex; gap: 0.5rem; font-size: 0.95rem; color: var(--gray-500); align-items: center;">
                    <span><a href="{{ url_for('index') }}" style="color: var(--primary-color); text-decoration: none; font-weight: 500;">In√≠cio</a></span>
                    <span aria-hidden="true" style="font-size: 1.1em; opacity: 0.7;">/</span>
                    <span aria-current="page" style="color: var(--primary-color); font-weight: 600;">Cadastro</span>
                </div>
            </nav>

            <div class="card fade-in">
                <div class="card-body" style="padding: 3rem;">
                    <!-- Header do Cadastro -->
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; font-size: 2rem; color: white;">
                            üìù
                        </div>
                        <h1 style="margin-bottom: 0.5rem;">Criar Nova Conta</h1>
                        <p style="color: var(--gray-600); margin-bottom: 0;">
                            Preencha os dados abaixo para solicitar acesso ao SGMRP
                        </p>
                    </div>

                    <!-- Formul√°rio de Cadastro -->
                    <form id="cadastroForm" method="POST" action="{{ url_for('cadastro') }}" novalidate>
                        <!-- Dados Pessoais -->
                        <fieldset style="border: none; margin-bottom: 2rem;">
                            <legend style="font-size: 1.125rem; font-weight: 600; color: var(--gray-700); margin-bottom: 1rem;">
                                Dados Pessoais
                            </legend>

                            <div class="grid grid-cols-2" style="gap: 1rem;">
                                <div class="form-group">
                                    <label for="nomeCompleto" class="form-label">
                                        Nome Completo <span style="color: var(--danger-color);">*</span>
                                    </label>
                                    <input 
                                        type="text" 
                                        id="nomeCompleto" 
                                        name="nome" 
                                        class="form-input" 
                                        placeholder="Digite seu nome completo"
                                        required
                                        autocomplete="name"
                                        aria-describedby="nomeCompleto-error"
                                    >
                                    <div id="nomeCompleto-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                                </div>

                                <div class="form-group">
                                    <label for="cpf" class="form-label">
                                        CPF <span style="color: var(--danger-color);">*</span>
                                    </label>
                                    <input 
                                        type="text" 
                                        id="cpf" 
                                        name="cpf" 
                                        class="form-input" 
                                        placeholder="000.000.000-00"
                                        required
                                        maxlength="14"
                                        aria-describedby="cpf-error"
                                    >
                                    <div id="cpf-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                                </div>
                            </div>

                            <div class="grid grid-cols-2" style="gap: 1rem;">
                                <div class="form-group">
                                    <label for="email" class="form-label">
                                        E-mail <span style="color: var(--danger-color);">*</span>
                                    </label>
                                    <input 
                                        type="email" 
                                        id="email" 
                                        name="email" 
                                        class="form-input" 
                                        placeholder="seu.email@exemplo.com"
                                        required
                                        autocomplete="email"
                                        aria-describedby="email-error"
                                    >
                                    <div id="email-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                                </div>

                                <div class="form-group">
                                    <label for="telefone" class="form-label">
                                        Telefone
                                    </label>
                                    <input 
                                        type="tel" 
                                        id="telefone" 
                                        name="telefone" 
                                        class="form-input" 
                                        placeholder="(00) 00000-0000"
                                        autocomplete="tel"
                                        aria-describedby="telefone-error"
                                    >
                                    <div id="telefone-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                                </div>
                            </div>
                        </fieldset>

                        <!-- Dados Profissionais -->
                        <fieldset style="border: none; margin-bottom: 2rem;">
                            <legend style="font-size: 1.125rem; font-weight: 600; color: var(--gray-700); margin-bottom: 1rem;">
                                Dados Profissionais
                            </legend>

                            <div class="form-group">
                                <label for="cargo" class="form-label">
                                    Cargo/Fun√ß√£o <span style="color: var(--danger-color);">*</span>
                                </label>
                                <select 
                                    id="cargo" 
                                    name="cargo" 
                                    class="form-select" 
                                    required
                                    aria-describedby="cargo-error"
                                >
                                    <option value="">Selecione seu cargo</option>
                                    <option value="funcionario_sfa">Funcion√°rio da SFA</option>
                                    <option value="supervisor">Supervisor do Sistema Penitenci√°rio</option>
                                    <option value="gestor">Gestor do Sistema Penitenci√°rio</option>
                                    <option value="auditor_interno">Auditor Interno</option>
                                    <option value="auditor_externo">Auditor Externo</option>
                                    <option value="coordenador_terceirizada">Coordenador de Empresa Terceirizada</option>
                                    <option value="administrativo">Funcion√°rio Administrativo</option>
                                    <option value="analista_financeiro">Analista Financeiro</option>
                                    <option value="outros">Outros</option>
                                </select>
                                <div id="cargo-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                            </div>

                            <div class="grid grid-cols-2" style="gap: 1rem;">
                                <div class="form-group">
                                    <label for="unidade" class="form-label">
                                        Unidade/√ìrg√£o <span style="color: var(--danger-color);">*</span>
                                    </label>
                                    <input 
                                        type="text" 
                                        id="unidade" 
                                        name="unidade" 
                                        class="form-input" 
                                        placeholder="Ex: SFA, SEAP, Empresa Terceirizada"
                                        required
                                        aria-describedby="unidade-error"
                                    >
                                    <div id="unidade-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                                </div>

                                <div class="form-group">
                                    <label for="matricula" class="form-label">
                                        Matr√≠cula/Registro
                                    </label>
                                    <input 
                                        type="text" 
                                        id="matricula" 
                                        name="matricula" 
                                        class="form-input" 
                                        placeholder="N√∫mero da matr√≠cula"
                                        aria-describedby="matricula-error"
                                    >
                                    <div id="matricula-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                                </div>
                            </div>
                        </fieldset>

                        <!-- Dados de Acesso -->
                        <fieldset style="border: none; margin-bottom: 2rem;">
                            <legend style="font-size: 1.125rem; font-weight: 600; color: var(--gray-700); margin-bottom: 1rem;">
                                Dados de Acesso
                            </legend>

                            <div class="form-group">
                                <label for="usuario" class="form-label">
                                    Nome de Usu√°rio <span style="color: var(--danger-color);">*</span>
                                </label>
                                <input 
                                    type="text" 
                                    id="usuario" 
                                    name="usuario" 
                                    class="form-input" 
                                    placeholder="Escolha um nome de usu√°rio"
                                    required
                                    autocomplete="username"
                                    aria-describedby="usuario-error usuario-hint"
                                >
                                <div id="usuario-hint" style="font-size: 0.75rem; color: var(--gray-500); margin-top: 0.25rem;">
                                    M√≠nimo 3 caracteres, apenas letras, n√∫meros e underline
                                </div>
                                <div id="usuario-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                            </div>

                            <div class="grid grid-cols-2" style="gap: 1rem;">
                                <div class="form-group">
                                    <label for="senha" class="form-label">
                                        Senha <span style="color: var(--danger-color);">*</span>
                                    </label>
                                    <div style="position: relative;">
                                        <input 
                                            type="password" 
                                            id="senha" 
                                            name="senha" 
                                            class="form-input" 
                                            placeholder="Crie uma senha segura"
                                            required
                                            autocomplete="new-password"
                                            aria-describedby="senha-error senha-strength"
                                            style="padding-right: 3rem;"
                                        >
                                        <button 
                                            type="button" 
                                            id="toggleSenha"
                                            style="position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--gray-500); cursor: pointer; padding: 0.25rem;"
                                            aria-label="Mostrar/ocultar senha"
                                        >
                                            üëÅÔ∏è
                                        </button>
                                    </div>
                                    <div id="senha-strength" style="font-size: 0.75rem; margin-top: 0.25rem;">
                                        <span>For√ßa da senha:</span>
                                        <div style="width: 100%; height: 4px; background-color: var(--gray-200); border-radius: 2px; margin-top: 0.25rem;">
                                            <div id="senha-strength-bar" style="height: 100%; border-radius: 2px; transition: all 0.3s ease; width: 0%;"></div>
                                        </div>
                                    </div>
                                    <div id="senha-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                                </div>

                                <div class="form-group">
                                    <label for="confirmarSenha" class="form-label">
                                        Confirmar Senha <span style="color: var(--danger-color);">*</span>
                                    </label>
                                    <input 
                                        type="password" 
                                        id="confirmarSenha" 
                                        name="confirmarSenha" 
                                        class="form-input" 
                                        placeholder="Confirme sua senha"
                                        required
                                        autocomplete="new-password"
                                        aria-describedby="confirmarSenha-error"
                                    >
                                    <div id="confirmarSenha-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                                </div>
                            </div>
                        </fieldset>

                        <!-- Justificativa -->
                        <fieldset style="border: none; margin-bottom: 2rem;">
                            <legend style="font-size: 1.125rem; font-weight: 600; color: var(--gray-700); margin-bottom: 1rem;">
                                Justificativa de Acesso
                            </legend>

                            <div class="form-group">
                                <label for="justificativa" class="form-label">
                                    Motivo da solicita√ß√£o <span style="color: var(--danger-color);">*</span>
                                </label>
                                <textarea 
                                    id="justificativa" 
                                    name="justificativa" 
                                    class="form-textarea" 
                                    placeholder="Descreva brevemente o motivo pelo qual voc√™ precisa de acesso ao sistema SGMRP"
                                    required
                                    rows="4"
                                    aria-describedby="justificativa-error justificativa-hint"
                                ></textarea>
                                <div id="justificativa-hint" style="font-size: 0.75rem; color: var(--gray-500); margin-top: 0.25rem;">
                                    M√≠nimo 20 caracteres. Esta informa√ß√£o ser√° avaliada pelo administrador.
                                </div>
                                <div id="justificativa-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                            </div>
                        </fieldset>

                        <!-- Termos e Condi√ß√µes -->
                        <div class="form-group">
                            <label style="display: flex; align-items: flex-start; gap: 0.5rem; cursor: pointer;">
                                <input 
                                    type="checkbox" 
                                    id="aceitarTermos" 
                                    name="aceitarTermos" 
                                    required
                                    style="margin-top: 0.25rem;"
                                >
                                <span style="font-size: 0.875rem; color: var(--gray-600);">
                                    Declaro que as informa√ß√µes fornecidas s√£o verdadeiras e concordo com os 
                                    <a href="#" style="color: var(--primary-color);" id="linkTermos">termos de uso</a> 
                                    e 
                                    <a href="#" style="color: var(--primary-color);" id="linkPrivacidade">pol√≠tica de privacidade</a> 
                                    do SGMRP. <span style="color: var(--danger-color);">*</span>
                                </span>
                            </label>
                            <div id="aceitarTermos-error" class="error-message" style="display: none; color: var(--danger-color); font-size: 0.875rem; margin-top: 0.25rem;"></div>
                        </div>

                        <!-- Bot√£o de Cadastro -->
                        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1.5rem;" id="cadastroButton">
                            <span id="cadastroButtonText">Enviar Solicita√ß√£o de Cadastro</span>
                            <span id="cadastroButtonSpinner" style="display: none;">Enviando...</span>
                        </button>
                    </form>

                    <!-- Divisor -->
                    <div style="text-align: center; margin: 2rem 0; position: relative;">
                        <hr style="border: none; border-top: 1px solid var(--gray-200);">
                        <span style="background-color: white; color: var(--gray-500); padding: 0 1rem; position: absolute; top: -0.5rem; left: 50%; transform: translateX(-50%); font-size: 0.875rem;">
                            J√° tem uma conta?
                        </span>
                    </div>

                    <!-- Link para Login -->
                    <div style="text-align: center;">
                        <a href="{{ url_for('login') }}" class="btn btn-secondary" style="width: 100%;">
                            Fazer Login
                        </a>
                    </div>
                </div>
            </div>

            <!-- Informa√ß√µes sobre o processo -->
            <div class="alert alert-info" style="margin-top: 2rem;">
                <h4 style="margin-bottom: 0.5rem;">Processo de Aprova√ß√£o</h4>
                <p style="margin-bottom: 0.5rem; font-size: 0.875rem;">
                    Sua solicita√ß√£o de cadastro ser√° analisada pelo administrador do sistema em at√© 48 horas √∫teis.
                </p>
                <p style="margin-bottom: 0; font-size: 0.875rem;">
                    <strong>Voc√™ receber√° um e-mail</strong> confirmando a aprova√ß√£o ou solicitando informa√ß√µes adicionais.
                </p>
            </div>
        </div>
    </main>

    <footer>
        <div class="container text-center">
            <p style="margin: 0; color: var(--gray-400); font-size: 0.875rem;">
                ¬© 2025 SGMRP - Sistema de Gerenciamento de Mapas de Refei√ß√µes Penitenci√°rio
            </p>
        </div>
    </footer>

    <script>
        // M√°scaras para inputs
        function applyCpfMask(value) {
            return value
                .replace(/\D/g, '')
                .replace(/(\d{3})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d{1,2})/, '$1-$2')
                .replace(/(-\d{2})\d+?$/, '$1');
        }

        function applyPhoneMask(value) {
            return value
                .replace(/\D/g, '')
                .replace(/(\d{2})(\d)/, '($1) $2')
                .replace(/(\d{5})(\d)/, '$1-$2')
                .replace(/(-\d{4})\d+?$/, '$1');
        }

        // Aplicar m√°scaras
        document.getElementById('cpf').addEventListener('input', function(e) {
            e.target.value = applyCpfMask(e.target.value);
        });

        document.getElementById('telefone').addEventListener('input', function(e) {
            e.target.value = applyPhoneMask(e.target.value);
        });

        // Toggle para mostrar/ocultar senha
        document.getElementById('toggleSenha').addEventListener('click', function() {
            const senhaInput = document.getElementById('senha');
            const toggleButton = document.getElementById('toggleSenha');
            
            if (senhaInput.type === 'password') {
                senhaInput.type = 'text';
                toggleButton.textContent = 'üôà';
                toggleButton.setAttribute('aria-label', 'Ocultar senha');
            } else {
                senhaInput.type = 'password';
                toggleButton.textContent = 'üëÅÔ∏è';
                toggleButton.setAttribute('aria-label', 'Mostrar senha');
            }
        });

        // Validador de for√ßa da senha
        function checkPasswordStrength(password) {
            let strength = 0;
            if (password.length >= 8) strength += 25;
            if (password.match(/[a-z]/)) strength += 25;
            if (password.match(/[A-Z]/)) strength += 25;
            if (password.match(/[0-9]/)) strength += 25;
            if (password.match(/[^A-Za-z0-9]/)) strength += 25;

            return Math.min(strength, 100);
        }

        document.getElementById('senha').addEventListener('input', function() {
            const password = this.value;
            const strengthBar = document.getElementById('senha-strength-bar');
            const strength = checkPasswordStrength(password);
            
            strengthBar.style.width = strength + '%';
            
            if (strength < 50) {
                strengthBar.style.backgroundColor = 'var(--danger-color)';
            } else if (strength < 75) {
                strengthBar.style.backgroundColor = 'var(--warning-color)';
            } else {
                strengthBar.style.backgroundColor = 'var(--success-color)';
            }
        });

        // ===== VALIDA√á√ÉO EM TEMPO REAL =====
        
        // Campos que devem ser validados em tempo real
        const camposValidar = ['email', 'cpf', 'usuario', 'matricula', 'telefone'];
        
        // Configurar listeners para valida√ß√£o em tempo real
        camposValidar.forEach(campo => {
            const elemento = document.getElementById(campo);
            if (elemento) {
                elemento.addEventListener('blur', validarCampoTempo);
                elemento.addEventListener('input', limparMensagemValidacao);
            }
        });
        
        // Fun√ß√£o para validar campo em tempo real
        async function validarCampoTempo(e) {
            const campo = e.target.id;
            const valor = e.target.value.trim();
            
            // Limpar mensagem anterior
            limparMensagemValidacao(e);
            
            if (!valor) return;
            
            // Mostrar loading
            mostrarMensagemValidacao(campo, 'Verificando...', 'loading');
            
            try {
                const response = await fetch('/api/validar-campo', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        campo: campo,
                        valor: valor
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Erro na valida√ß√£o');
                }
                
                const data = await response.json();

                // Limpar loading
                limparMensagemValidacao(e);

                // usar campo retornado pelo servidor se presente (ajuda em requisi√ß√µes concorrentes)
                const responseCampo = data.campo || campo;

                // Mostrar resultado
                if (data.valido) {
                    mostrarMensagemValidacao(responseCampo, data.mensagem || 'Dispon√≠vel!', 'success');
                } else {
                    mostrarMensagemValidacao(responseCampo, data.mensagem, 'error');
                }
                
            } catch (error) {
                console.error('Erro na valida√ß√£o:', error);
                limparMensagemValidacao(e);
                mostrarMensagemValidacao(campo, 'Erro ao verificar. Tente novamente.', 'error');
            }
        }
        
        // Fun√ß√£o para limpar mensagens de valida√ß√£o
        function limparMensagemValidacao(e) {
            const campo = e.target.id;
            const mensagemDiv = document.getElementById(`msg-${campo}`);
            if (mensagemDiv) {
                mensagemDiv.remove();
            }
        }
        
        // Fun√ß√£o para mostrar mensagem de valida√ß√£o
        function mostrarMensagemValidacao(campo, mensagem, tipo) {
            const elemento = document.getElementById(campo);
            const mensagemDiv = document.createElement('div');
            mensagemDiv.id = `msg-${campo}`;
            mensagemDiv.className = `validation-message ${tipo}`;
            mensagemDiv.textContent = mensagem;
            
            elemento.parentNode.insertBefore(mensagemDiv, elemento.nextSibling);
        }

        // ===== VALIDA√á√ÉO DO FORMUL√ÅRIO =====
        
        // Valida√ß√£o do formul√°rio
        function validateForm() {
            let isValid = true;
            const fields = [
                'nomeCompleto', 'cpf', 'email', 'cargo', 'unidade', 
                'usuario', 'senha', 'confirmarSenha', 'justificativa'
            ];
            
            // Limpar erros anteriores
            clearErrors();
            
            // Validar cada campo
            fields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                const value = field.value.trim();
                
                if (!value && field.hasAttribute('required')) {
                    showError(fieldId, 'Este campo √© obrigat√≥rio');
                    isValid = false;
                    return;
                }
                
                // Valida√ß√µes espec√≠ficas
                switch(fieldId) {
                    case 'email':
                        if (value && !isValidEmail(value)) {
                            showError(fieldId, 'Digite um e-mail v√°lido');
                            isValid = false;
                        }
                        break;
                    case 'cpf':
                        if (value && !isValidCPF(value.replace(/\D/g, ''))) {
                            showError(fieldId, 'Digite um CPF v√°lido');
                            isValid = false;
                        }
                        break;
                    case 'usuario':
                        if (value && (value.length < 3 || !/^[a-zA-Z0-9_]+$/.test(value))) {
                            showError(fieldId, 'Nome de usu√°rio deve ter pelo menos 3 caracteres e conter apenas letras, n√∫meros e underscore');
                            isValid = false;
                        }
                        break;
                    case 'senha':
                        if (value && checkPasswordStrength(value) < 50) {
                            showError(fieldId, 'Senha muito fraca. Use pelo menos 8 caracteres com letras mai√∫sculas, min√∫sculas e n√∫meros');
                            isValid = false;
                        }
                        break;
                    case 'confirmarSenha':
                        if (value && value !== document.getElementById('senha').value) {
                            showError(fieldId, 'As senhas n√£o coincidem');
                            isValid = false;
                        }
                        break;
                    case 'justificativa':
                        if (value && value.length < 20) {
                            showError(fieldId, 'A justificativa deve ter pelo menos 20 caracteres');
                            isValid = false;
                        }
                        break;
                }
            });
            
            // Validar checkbox de termos
            if (!document.getElementById('aceitarTermos').checked) {
                showError('aceitarTermos', 'Voc√™ deve aceitar os termos de uso para continuar');
                isValid = false;
            }
            
            return isValid;
        }

        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function isValidCPF(cpf) {
            if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
            
            let sum = 0;
            for (let i = 0; i < 9; i++) {
                sum += parseInt(cpf[i]) * (10 - i);
            }
            let digit1 = 11 - (sum % 11);
            if (digit1 > 9) digit1 = 0;
            
            sum = 0;
            for (let i = 0; i < 10; i++) {
                sum += parseInt(cpf[i]) * (11 - i);
            }
            let digit2 = 11 - (sum % 11);
            if (digit2 > 9) digit2 = 0;
            
            return digit1 === parseInt(cpf[9]) && digit2 === parseInt(cpf[10]);
        }

        function showError(fieldId, message) {
            const field = document.getElementById(fieldId);
            const errorDiv = document.getElementById(fieldId + '-error');
            
            field.classList.add('error');
            field.style.borderColor = 'var(--danger-color)';
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function clearErrors() {
            const errorDivs = document.querySelectorAll('.error-message');
            const inputs = document.querySelectorAll('input, select, textarea');
            
            errorDivs.forEach(div => {
                div.style.display = 'none';
                div.textContent = '';
            });
            
            inputs.forEach(input => {
                input.classList.remove('error');
                input.style.borderColor = '';
            });
        }

        // Limpar erros quando o usu√°rio come√ßa a digitar
        document.querySelectorAll('input, select, textarea').forEach(field => {
            field.addEventListener('input', function() {
                if (this.value.trim() || this.type === 'checkbox') {
                    this.style.borderColor = '';
                    const errorDiv = document.getElementById(this.id + '-error');
                    if (errorDiv) {
                        errorDiv.style.display = 'none';
                    }
                }
            });
        });

        // Submiss√£o do formul√°rio
        document.getElementById('cadastroForm').addEventListener('submit', function(e) {
            if (!validateForm()) {
                e.preventDefault();
                return false;
            }
            
            // Verificar se h√° erros de valida√ß√£o em tempo real
            const errosValidacao = document.querySelectorAll('.validation-message.error');
            if (errosValidacao.length > 0) {
                e.preventDefault();
                alert('Por favor, corrija os erros antes de prosseguir.');
                return false;
            }
            
            // Se valida√ß√£o passou, permitir envio normal do formul√°rio
            // Mostrar estado de loading
            const button = document.getElementById('cadastroButton');
            const buttonText = document.getElementById('cadastroButtonText');
            const buttonSpinner = document.getElementById('cadastroButtonSpinner');
            
            button.disabled = true;
            buttonText.style.display = 'none';
            buttonSpinner.style.display = 'inline';
            
            // Formul√°rio ser√° enviado normalmente para o Flask
        });

        // Links dos termos
        document.getElementById('linkTermos').addEventListener('click', function(e) {
            e.preventDefault();
            alert('Termos de Uso:\n\n1. Este sistema √© de uso exclusivo para profissionais autorizados\n2. Todas as a√ß√µes s√£o registradas e monitoradas\n3. √â proibido compartilhar credenciais de acesso\n4. Dados devem ser tratados com confidencialidade\n5. Uso indevido resultar√° em bloqueio do acesso');
        });

        document.getElementById('linkPrivacidade').addEventListener('click', function(e) {
            e.preventDefault();
            alert('Pol√≠tica de Privacidade:\n\n- Seus dados pessoais s√£o protegidos e usados apenas para autentica√ß√£o\n- N√£o compartilhamos informa√ß√µes com terceiros\n- Dados de acesso s√£o criptografados\n- Voc√™ pode solicitar exclus√£o dos seus dados a qualquer momento');
        });

        // Anima√ß√£o de fade-in
        document.querySelectorAll('.fade-in').forEach(el => {
            el.style.opacity = '0';
            el.style.transform = 'translateY(30px)';
            el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            
            setTimeout(() => {
                el.style.opacity = '1';
                el.style.transform = 'translateY(0)';
            }, 100);
        });
    </script>
</body>
</html>
